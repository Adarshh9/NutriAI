# NutriAI: Personalized Nutrition Recommendation System

## Overview

NutriAI is an advanced nutrition recommendation system that leverages multiple AI technologies to suggest foods beneficial for specific health conditions. The system combines knowledge graphs, graph neural networks, text retrieval, and natural language processing to provide evidence-based nutritional recommendations.

## Key Components

### 1. Multi-Modal AI Architecture

NutriAI employs a sophisticated multi-modal approach combining three core AI technologies:

- **Knowledge Graph (KG)**: Structured representation of food-disease relationships
- **Graph Neural Network (GNN)**: Learns patterns from the knowledge graph to predict new food-disease relationships
- **Text Retrieval**: Provides scientific evidence from medical literature supporting recommendations

### 2. Reinforcement Learning Cache System

Implements an intelligent caching mechanism that:
- Uses Q-learning to determine which queries to cache
- Optimizes response times for frequently requested explanations
- Persists learning and cache data between sessions

### 3. NLP Integration with Groq LLM API

- Connects to Groq's LLama-3-70B model for generating concise, scientific explanations 
- Explains why specific foods might be beneficial or harmful for particular conditions
- Communicates complex nutritional science in accessible language

### 4. Visualization Component

- Generates network visualizations showing relationships between foods and diseases
- Helps users understand the interconnections in the knowledge graph
- Provides visual context for recommendations

## System Pipeline Flow

1. **Input Processing**:
   - User selects a disease/condition via web interface
   - Query is normalized and processed

2. **Multi-Model Recommendation Generation**:
   - **KG Model** retrieves established food-disease relationships from the knowledge graph
   - **GNN Model** predicts novel food recommendations based on learned patterns
   - Both models provide complementary perspectives on beneficial foods

3. **Evidence Collection**:
   - Each recommended food is paired with supporting evidence:
     - Nutritional data (key nutrients, caloric content, macronutrients)
     - Scientific literature extracted via text retrieval
     - Concise explanations generated by the LLM

4. **Result Presentation**:
   - Web interface displays organized recommendations
   - Users can request additional explanations for specific foods
   - Optional network visualization shows the relationships in context

5. **Intelligent Caching**:
   - System learns which explanations to cache based on response time and usage patterns
   - Cache management interface allows monitoring and control

## Technical Components

### Data Models

- **KG Data**: Structured food-disease relationships with evidence links
- **Nutrient Data**: Detailed nutritional information for recommended foods
- **GNN Model**: PyTorch Geometric implementation of a Graph Convolutional Network
- **Text Retrieval**: FAISS vector index with biomedical embeddings from PubMedBERT

### Backend Technologies

- **Framework**: Flask web server
- **ML Libraries**: PyTorch, PyTorch Geometric, FAISS, SentenceTransformer
- **Graph Processing**: NetworkX for graph manipulation and visualization
- **NLP**: Integration with Groq API (LLama-3-70B model)

### Frontend

- **Web Interface**: HTML templates with dynamic rendering
- **Visualization**: matplotlib-generated network visualizations
- **Interactive Elements**: AJAX-powered explanation requests

## Key Features

### 1. Evidence-Based Recommendations

Each food recommendation is backed by three types of evidence:
- Knowledge graph assertions with sources
- Nutritional composition data
- Retrieved scientific literature

### 2. Novel Food Discovery

The GNN model can suggest foods that aren't explicitly linked to a condition in the knowledge graph but may still be beneficial based on learned patterns.

### 3. Intelligent Explanation System

- Generates concise, scientifically-grounded explanations
- Uses reinforcement learning to optimize caching strategy
- Improves performance over time based on usage patterns

### 4. Visualization Tools

Network visualizations help users understand the relationships between foods, diseases, and connecting elements in the knowledge graph.

### 5. Cache Management System

- Administrators can view, search, and clear the explanation cache
- System displays cache performance metrics
- RL-based decisions evolve with usage patterns

## Deployment Instructions

1. Install required Python packages
2. Configure Groq API key in configs.py
3. Ensure model files are in correct locations
4. Run `app.py` to start the Flask server

## Usage Scenarios

### For Patients

- Input a medical condition to receive food recommendations
- Understand why specific foods might be beneficial
- Explore supporting scientific evidence

### For Healthcare Providers  

- Provide evidence-based nutritional guidance for specific conditions
- Access scientific justifications for recommendations
- Visualize food-disease relationships

### For Researchers

- Explore the knowledge graph structure
- Analyze prediction patterns from the GNN
- Examine the scientific literature supporting relationships

## Future Enhancements

- User profiles and personalized recommendations
- Mobile application interface
- Integration with electronic health records
- Expanded knowledge graph with more foods and conditions
- Temporal analysis of changing nutritional science

## Conclusion

NutriAI represents a sophisticated integration of knowledge graphs, graph neural networks, and natural language processing to provide evidence-based nutritional recommendations. By combining structured knowledge with machine learning capabilities, it offers a powerful tool for understanding the complex relationships between food and health.
